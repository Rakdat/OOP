package ru.nsu.tokarev4;

import java.util.Map;

/**
 * Интерфейс, представляющий математическое выражение.
 * Является корнем иерархии классов для работы с выражениями.
 *
 * <p>Примеры создания выражений:
 * <pre>
 * // Создание вручную
 * Expression expr = new Add(
 *     new Number(3),
 *     new Mul(new Number(2), new Variable("x"))
 * );
 *
 * // Парсинг из строки
 * Expression parsed = ExpressionParser.parse("(3+(2*x))");
 * </pre>
 *
 * <p>Возможности выражений:
 * <ul>
 *   <li>Вычисление значения при заданных переменных</li>
 *   <li>Символьное дифференцирование по переменной</li>
 *   <li>Строковое представление через toString()</li>
 * </ul>
 *
 * <p>Для добавления новой операции необходимо:
 * <ol>
 *   <li>Создать класс, реализующий Expression</li>
 *   <li>Реализовать методы eval(), derivative()</li>
 *   <li>Переопределить метод toString() для строкового представления</li>
 *   <li>Добавить поддержку в ExpressionParser</li>
 * </ol>
 *
 * <p>Метод toString() должен возвращать строковое представление выражения
 * в формате с круглыми скобками, например: "(3+(2*x))"
 */
public interface Expression {

    /**
     * Вычисляет значение выражения при заданных значениях переменных.
     *
     * @param variables карта переменных: имя → значение
     * @return результат вычисления выражения
     * @throws IllegalArgumentException если переменная не найдена
     */
    int eval(Map<String, Integer> variables);

    /**
     * Вычисляет производную выражения по заданной переменной.
     *
     * @param variableName имя переменной, по которой производится дифференцирование
     * @return новое выражение, представляющее производную
     */
    Expression derivative(String variableName);
}